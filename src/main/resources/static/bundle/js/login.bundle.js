import{r as h,a as o,j as g,c as y}from"../chunk/client.chunk.js";function b(){const[i,v]=h.useState(""),[l,w]=h.useState();h.useEffect(()=>{(()=>{const e=new URLSearchParams(window.location.search),t=e.get("code"),c=e.get("state");t&&c&&console.log("네이버 로그인 콜백 감지:",t)})(),(()=>{if(document.getElementById("naver-login-sdk")){a();return}const e=document.createElement("script");e.id="naver-login-sdk",e.src="https://static.nid.naver.com/js/naveridlogin_js_sdk_2.0.2.js",e.charset="utf-8",e.onload=()=>{console.log("네이버 SDK 로드 완료"),a()},e.onerror=t=>{console.error("네이버 SDK 로드 실패:",t)},document.head.appendChild(e)})();const a=()=>{try{if(window.naver){const e=new window.naver.LoginWithNaverId({clientId:"jofTdxFhK3nCE5655eYo",callbackUrl:"http://localhost:8888/login.do",isPopup:!1,loginButton:{color:"green",type:3,height:40}});e.init(),e.getLoginStatus(function(t){if(t){const c=e.user.email,r=e.user.name,d=e.user.nickname,p=e.user.birthday,m=e.user.birthyear,u=e.user.mobile;console.log("네이버 로그인 성공:",c,r,d,m,p,u),f(c,r,d,m,p,u)}}),console.log("네이버 로그인 초기화 성공")}else console.error("window.naver 객체가 존재하지 않음")}catch(e){console.error("네이버 로그인 초기화 중 오류:",e)}}},[]);const f=async(n,s,a,e,t,c)=>{try{const r=await fetch("http://localhost:8888/api/v1/naver-login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:n,name:s,nickName:a,birthyear:e,birthday:t,mobile:c})});if(r.ok){const d=await r.json();console.log("네이버 로그인 서버 응답:",d),window.location.href="/home.do"}else console.error("네이버 로그인 처리 실패")}catch(r){console.error("네이버 로그인 요청 오류:",r)}};return o("section",{children:g("div",{className:"sec",children:[o("div",{children:o("img",{src:"./img/logo.png",alt:"Logo",width:"200px",height:"200px"})}),o("form",{children:g("div",{className:"ip-box",children:[o("input",{type:"text",placeholder:"아이디",value:i,onChange:n=>{v(n.target.value),console.log(i)}}),o("br",{}),o("input",{type:"password",placeholder:"비밀번호",value:l,onChange:n=>{w(n.target.value),console.log(l)}})]})}),g("div",{className:"side-btn",children:[o("a",{href:"searchid.do",children:"아이디 찾기"}),"|",o("a",{href:"searchpw.do",children:"비밀번호 찾기"}),"|",o("a",{href:"join.do",children:"회원가입"})]}),o("div",{children:o("button",{type:"button",className:"login-btn",onClick:async n=>{n.preventDefault();const s=new URLSearchParams;s.append("id",i),s.append("pw",l);const a=await fetch("http://localhost:8888/api/v1/login",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:s});if(a.status===401)alert("아이디와 비밀번호를 확인하세요");else{const e=await a.json();sessionStorage.setItem("token",e.token)}console.log(`로그인 시도: 아이디=${i}, 비밀번호=${l}`)},children:"로그인"})}),o("div",{id:"naverIdLogin"})]})})}const k=y.createRoot(document.getElementById("root"));k.render(o(b,{}));
